#summary Сетевая модель.

= Сетевая модель =

  # ProxyARP
  # NAT
  # Bridge

= ProxyARP =

  * Текущий вариант по умолчанию.
  * Ферма работает как маршрутизатор между внешней сетью и контейнерами.
  * Можно использовать iptables для фильтрации, iproute, tc для шейпинга, и т.д.
  * *Контейнерам должны назначаться IP из той же подсети, в которую входит внешний интерфейс фермы, иначе ProxyARP не сможет пропускать трафик.*
  * MAC-адреса контейнеров видны только ферме, во внешней сети контейнеры видны с MAC-адресом фермы.
  * Взять себе чужой IP контейнер не может - ферма маршрутизирует только от/к разрешённым.
  * DHCP-сервер (dnsmasq) должен быть запущен на самой ферме, т.к. ProxyARP не пропустит трафик из контейнера во внешнюю сеть, пока тот не имеет IP.

= NAT =

  * Не реализовано.
  * Контейнеры имеют IP-адреса из приватной сети и снаружи недоступны.
  * Для доступа контейнеров к внешней сети в iptables включается SNAT или маскарадинг.
  * Остальное как в ProxyARP.

= Bridge =

  * Не реализовано.
  * На ферме создаётся сетевой мост, в него подключается внешний интерфейс.
  * Создаваемые при запуске контейнеров TAP-интерфейсы также подключаются в него.
  * Подмену MAC и IP контейнерами ферма не блокирует.
  * DHCP-сервер при этом общий на всю сеть, dnsmasq на ферме не запускается.
  * Для перехвата трафика ферма должна использовать promiscous-режим, для фильтрации ebtables.